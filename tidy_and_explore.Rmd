---
title: "As5697_tidying_and_exploratory"
author: "Apoorva Srinivasan"
date: "12/10/2018"
output: github_document
---

```{r}
library(tidyverse)

```

```{r}
cancer_reg = read_csv("./data/Cancer_Registry.csv") %>%
  janitor::clean_names() %>%
  select(target_death_rate, everything()) %>%
  separate(geography, into = c("county", "state"), sep = ",")
```

There are in total `r ncol(cancer_reg)` variables  and `r nrow(cancer_reg)`observations in the dataset. 


```{r}
#missing data

#colSums(is.na(cancer_reg))  #pct_some_col18_24 has 2285 NAs, pct_employed_coverage_alone has 609 NA, pct_employed16_over has 152 NAs


missing_value = sapply(cancer_reg[1:34], function(x) sum(length(which(is.na(x)))))


# Percentage of missing value
percentage_missing = sapply(cancer_reg[1:34], function(x) sum(length(which(is.na(x)))) / nrow(cancer_reg))
percentage_missing %>% data.frame()

##getting rid of variables with missing values

cancer_reg %>% select(-pct_some_col18_24, -pct_private_coverage_alone)

##percentage missing for pct_employed16_over is  ~5%, checking to see if its correlated with the outcome 
reg = lm(target_death_rate~pct_employed16_over, data = cancer_reg) %>%
  summary()

##Since the p-value is small, we will retain pct_employed16_over
```


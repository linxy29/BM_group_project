jy2947-Dec15
================
Jiawei Ye
December 15, 2018

### The final model we decided

``` r
#load
cancer_reg = read_csv("./data/Cancer_Registry.csv") %>%
  janitor::clean_names() %>%
  dplyr::select(target_death_rate, everything()) %>%
  separate(geography, into = c("county", "state"), sep = ", ") %>% 
  mutate(county = str_replace(county, " ", ""))
```

    ## Parsed with column specification:
    ## cols(
    ##   .default = col_double(),
    ##   binnedInc = col_character(),
    ##   Geography = col_character()
    ## )

    ## See spec(...) for full column specifications.

``` r
#exclude variables with a lot missing data, categorical variables and high collinearity variables
cancer_reg_tidy = 
  cancer_reg %>% 
  dplyr::select(-pct_employed16_over, -pct_some_col18_24, -pct_private_coverage_alone, #missing data
                -county, -state, -binned_inc, -avg_ann_count, -avg_deaths_per_year) %>%   #categorical, colinearity
  dplyr::select(-med_income, -median_age_female, -pct_emp_priv_coverage, 
                -pct_public_coverage, -pct_private_coverage,  -poverty_percent, 
                -pct_hs25_over, -percent_married) %>% #colinearity
  mutate(pct_nonwhite = 1 - pct_white)

# define full and null sets for forward, backward, both ways search procedures
null = lm(target_death_rate ~ 1, data = cancer_reg_tidy)

full = lm(target_death_rate ~ ., data = cancer_reg_tidy)

# forward
step(null, scope = list(lower = null, upper = full), direction = "forward")
```

    ## Start:  AIC=20253.13
    ## target_death_rate ~ 1
    ## 
    ##                             Df Sum of Sq     RSS   AIC
    ## + pct_bach_deg25_over        1    552893 1792973 19436
    ## + incidence_rate             1    473839 1872027 19568
    ## + pct_public_coverage_alone  1    473682 1872183 19568
    ## + pct_unemployed16_over      1    335919 2009947 19784
    ## + pct_married_households     1    201838 2144028 19981
    ## + pct_bach_deg18_24          1    194329 2151537 19992
    ## + pct_hs18_24                1    161000 2184866 20039
    ## + pct_black                  1    154971 2190895 20047
    ## + pct_other_race             1     84591 2261275 20143
    ## + pct_asian                  1     81447 2264419 20148
    ## + pct_white                  1     73826 2272040 20158
    ## + pct_nonwhite               1     73826 2272040 20158
    ## + pop_est2015                1     33822 2312044 20211
    ## + pct_no_hs18_24             1     18358 2327508 20231
    ## + birth_rate                 1     17922 2327944 20232
    ## + avg_household_size         1      3195 2342671 20251
    ## <none>                                   2345866 20253
    ## + study_per_cap              1      1165 2344701 20254
    ## + median_age_male            1      1128 2344738 20254
    ## + median_age                 1        45 2345821 20255
    ## 
    ## Step:  AIC=19436.16
    ## target_death_rate ~ pct_bach_deg25_over
    ## 
    ##                             Df Sum of Sq     RSS   AIC
    ## + incidence_rate             1    436199 1356774 18589
    ## + pct_married_households     1    142974 1649999 19185
    ## + pct_unemployed16_over      1    106117 1686856 19252
    ## + pct_public_coverage_alone  1     89344 1703629 19282
    ## + pct_black                  1     82887 1710086 19294
    ## + pct_other_race             1     68639 1724334 19319
    ## + pct_white                  1     55608 1737365 19342
    ## + pct_nonwhite               1     55608 1737365 19342
    ## + birth_rate                 1     40016 1752957 19369
    ## + pct_no_hs18_24             1     30147 1762826 19387
    ## + median_age_male            1     17581 1775392 19408
    ## + pct_hs18_24                1     12028 1780945 19418
    ## + study_per_cap              1      2199 1790774 19434
    ## + avg_household_size         1      2133 1790840 19435
    ## + pct_asian                  1      2006 1790967 19435
    ## + pop_est2015                1      1525 1791448 19436
    ## <none>                                   1792973 19436
    ## + median_age                 1        71 1792902 19438
    ## + pct_bach_deg18_24          1        42 1792931 19438
    ## 
    ## Step:  AIC=18588.76
    ## target_death_rate ~ pct_bach_deg25_over + incidence_rate
    ## 
    ##                             Df Sum of Sq     RSS   AIC
    ## + pct_public_coverage_alone  1     80817 1275957 18404
    ## + pct_married_households     1     79924 1276850 18406
    ## + pct_unemployed16_over      1     70660 1286114 18428
    ## + pct_white                  1     51737 1305036 18472
    ## + pct_nonwhite               1     51737 1305036 18472
    ## + pct_black                  1     47135 1309639 18483
    ## + pct_other_race             1     16303 1340471 18554
    ## + birth_rate                 1     14471 1342302 18558
    ## + median_age_male            1     14267 1342507 18559
    ## + pct_hs18_24                1     10915 1345859 18566
    ## + pct_bach_deg18_24          1      2635 1354139 18585
    ## + pct_no_hs18_24             1      1651 1355123 18587
    ## + pct_asian                  1      1480 1355294 18587
    ## + avg_household_size         1      1021 1355753 18589
    ## <none>                                   1356774 18589
    ## + median_age                 1       395 1356379 18590
    ## + pop_est2015                1       158 1356616 18590
    ## + study_per_cap              1        53 1356721 18591
    ## 
    ## Step:  AIC=18403.64
    ## target_death_rate ~ pct_bach_deg25_over + incidence_rate + pct_public_coverage_alone
    ## 
    ##                          Df Sum of Sq     RSS   AIC
    ## + pct_other_race          1   28916.0 1247041 18336
    ## + pct_married_households  1   24502.3 1251455 18347
    ## + pct_black               1   18664.6 1257292 18361
    ## + pct_unemployed16_over   1   15216.5 1260741 18369
    ## + pct_white               1   14355.2 1261602 18371
    ## + pct_nonwhite            1   14355.2 1261602 18371
    ## + pct_hs18_24             1   11850.9 1264106 18377
    ## + birth_rate              1   10071.1 1265886 18382
    ## + median_age_male         1    8493.2 1267464 18385
    ## + pct_no_hs18_24          1    5953.3 1270004 18391
    ## + pop_est2015             1    1585.4 1274372 18402
    ## <none>                                1275957 18404
    ## + pct_bach_deg18_24       1     608.8 1275348 18404
    ## + median_age              1     201.3 1275756 18405
    ## + study_per_cap           1     109.3 1275848 18405
    ## + avg_household_size      1      38.4 1275919 18406
    ## + pct_asian               1      27.1 1275930 18406
    ## 
    ## Step:  AIC=18335.79
    ## target_death_rate ~ pct_bach_deg25_over + incidence_rate + pct_public_coverage_alone + 
    ##     pct_other_race
    ## 
    ##                          Df Sum of Sq     RSS   AIC
    ## + pct_white               1   24974.5 1222067 18276
    ## + pct_nonwhite            1   24974.5 1222067 18276
    ## + pct_married_households  1   23831.6 1223210 18279
    ## + median_age_male         1   20202.2 1226839 18288
    ## + pct_black               1   16845.6 1230195 18296
    ## + pct_unemployed16_over   1   14407.7 1232633 18302
    ## + pct_hs18_24             1   10213.5 1236828 18313
    ## + birth_rate              1    8453.4 1238588 18317
    ## + pct_no_hs18_24          1    3631.1 1243410 18329
    ## + avg_household_size      1    1692.1 1245349 18334
    ## + pct_asian               1    1568.4 1245473 18334
    ## <none>                                1247041 18336
    ## + pct_bach_deg18_24       1     523.9 1246517 18337
    ## + median_age              1     333.2 1246708 18337
    ## + study_per_cap           1     125.2 1246916 18338
    ## + pop_est2015             1       0.0 1247041 18338
    ## 
    ## Step:  AIC=18276.15
    ## target_death_rate ~ pct_bach_deg25_over + incidence_rate + pct_public_coverage_alone + 
    ##     pct_other_race + pct_white
    ## 
    ##                          Df Sum of Sq     RSS   AIC
    ## + pct_hs18_24             1   12383.1 1209683 18247
    ## + birth_rate              1    9356.8 1212710 18255
    ## + median_age_male         1    8033.8 1214033 18258
    ## + pct_married_households  1    7434.5 1214632 18260
    ## + pct_no_hs18_24          1    5761.1 1216305 18264
    ## + pct_unemployed16_over   1    3995.1 1218071 18268
    ## <none>                                1222067 18276
    ## + pct_bach_deg18_24       1     416.1 1221650 18277
    ## + avg_household_size      1     399.3 1221667 18277
    ## + pop_est2015             1     310.0 1221757 18277
    ## + median_age              1     198.5 1221868 18278
    ## + study_per_cap           1      50.2 1222016 18278
    ## + pct_black               1      46.4 1222020 18278
    ## + pct_asian               1      10.5 1222056 18278
    ## 
    ## Step:  AIC=18247.12
    ## target_death_rate ~ pct_bach_deg25_over + incidence_rate + pct_public_coverage_alone + 
    ##     pct_other_race + pct_white + pct_hs18_24
    ## 
    ##                          Df Sum of Sq     RSS   AIC
    ## + median_age_male         1   12821.8 1196862 18217
    ## + pct_married_households  1   12166.7 1197517 18218
    ## + birth_rate              1   10007.8 1199676 18224
    ## + pct_no_hs18_24          1    4521.9 1205162 18238
    ## + pct_unemployed16_over   1    3927.9 1205756 18239
    ## <none>                                1209683 18247
    ## + median_age              1     358.0 1209326 18248
    ## + pop_est2015             1     247.3 1209436 18249
    ## + avg_household_size      1     182.8 1209501 18249
    ## + study_per_cap           1      27.2 1209656 18249
    ## + pct_asian               1      10.5 1209673 18249
    ## + pct_bach_deg18_24       1       6.3 1209677 18249
    ## + pct_black               1       4.5 1209679 18249
    ## 
    ## Step:  AIC=18216.65
    ## target_death_rate ~ pct_bach_deg25_over + incidence_rate + pct_public_coverage_alone + 
    ##     pct_other_race + pct_white + pct_hs18_24 + median_age_male
    ## 
    ##                          Df Sum of Sq     RSS   AIC
    ## + birth_rate              1   13242.8 1183619 18185
    ## + pct_married_households  1   11751.3 1185110 18189
    ## + pct_unemployed16_over   1    3087.4 1193774 18211
    ## + pct_no_hs18_24          1    2482.4 1194379 18212
    ## <none>                                1196862 18217
    ## + avg_household_size      1     443.0 1196419 18218
    ## + pop_est2015             1     366.1 1196496 18218
    ## + pct_black               1     207.1 1196655 18218
    ## + pct_bach_deg18_24       1     179.8 1196682 18218
    ## + pct_asian               1      90.8 1196771 18218
    ## + study_per_cap           1      77.4 1196784 18219
    ## + median_age              1      31.4 1196830 18219
    ## 
    ## Step:  AIC=18184.75
    ## target_death_rate ~ pct_bach_deg25_over + incidence_rate + pct_public_coverage_alone + 
    ##     pct_other_race + pct_white + pct_hs18_24 + median_age_male + 
    ##     birth_rate
    ## 
    ##                          Df Sum of Sq     RSS   AIC
    ## + pct_married_households  1    9580.5 1174038 18162
    ## + pct_unemployed16_over   1    1980.7 1181638 18182
    ## + pct_no_hs18_24          1    1444.6 1182174 18183
    ## <none>                                1183619 18185
    ## + pop_est2015             1     540.9 1183078 18185
    ## + avg_household_size      1     346.7 1183272 18186
    ## + pct_asian               1     214.5 1183404 18186
    ## + study_per_cap           1      29.2 1183590 18187
    ## + pct_bach_deg18_24       1      24.9 1183594 18187
    ## + median_age              1      24.2 1183595 18187
    ## + pct_black               1       0.0 1183619 18187
    ## 
    ## Step:  AIC=18161.98
    ## target_death_rate ~ pct_bach_deg25_over + incidence_rate + pct_public_coverage_alone + 
    ##     pct_other_race + pct_white + pct_hs18_24 + median_age_male + 
    ##     birth_rate + pct_married_households
    ## 
    ##                         Df Sum of Sq     RSS   AIC
    ## + pct_unemployed16_over  1   1765.12 1172273 18159
    ## <none>                               1174038 18162
    ## + pop_est2015            1    661.97 1173376 18162
    ## + pct_no_hs18_24         1    407.02 1173631 18163
    ## + study_per_cap          1    172.17 1173866 18164
    ## + pct_black              1    146.65 1173892 18164
    ## + pct_asian              1    101.76 1173937 18164
    ## + pct_bach_deg18_24      1     50.55 1173988 18164
    ## + avg_household_size     1     48.18 1173990 18164
    ## + median_age             1     40.24 1173998 18164
    ## 
    ## Step:  AIC=18159.4
    ## target_death_rate ~ pct_bach_deg25_over + incidence_rate + pct_public_coverage_alone + 
    ##     pct_other_race + pct_white + pct_hs18_24 + median_age_male + 
    ##     birth_rate + pct_married_households + pct_unemployed16_over
    ## 
    ##                      Df Sum of Sq     RSS   AIC
    ## + pop_est2015         1    790.39 1171483 18159
    ## <none>                            1172273 18159
    ## + pct_no_hs18_24      1    350.32 1171923 18161
    ## + study_per_cap       1    176.07 1172097 18161
    ## + pct_black           1    171.83 1172101 18161
    ## + pct_asian           1    122.05 1172151 18161
    ## + median_age          1     70.32 1172203 18161
    ## + pct_bach_deg18_24   1     10.41 1172263 18161
    ## + avg_household_size  1      9.62 1172264 18161
    ## 
    ## Step:  AIC=18159.34
    ## target_death_rate ~ pct_bach_deg25_over + incidence_rate + pct_public_coverage_alone + 
    ##     pct_other_race + pct_white + pct_hs18_24 + median_age_male + 
    ##     birth_rate + pct_married_households + pct_unemployed16_over + 
    ##     pop_est2015
    ## 
    ##                      Df Sum of Sq     RSS   AIC
    ## <none>                            1171483 18159
    ## + pct_no_hs18_24      1    407.06 1171076 18160
    ## + pct_black           1    198.25 1171285 18161
    ## + study_per_cap       1    159.92 1171323 18161
    ## + median_age          1     74.11 1171409 18161
    ## + avg_household_size  1     18.14 1171465 18161
    ## + pct_asian           1      3.59 1171479 18161
    ## + pct_bach_deg18_24   1      0.00 1171483 18161

    ## 
    ## Call:
    ## lm(formula = target_death_rate ~ pct_bach_deg25_over + incidence_rate + 
    ##     pct_public_coverage_alone + pct_other_race + pct_white + 
    ##     pct_hs18_24 + median_age_male + birth_rate + pct_married_households + 
    ##     pct_unemployed16_over + pop_est2015, data = cancer_reg_tidy)
    ## 
    ## Coefficients:
    ##               (Intercept)        pct_bach_deg25_over  
    ##                 1.398e+02                 -1.653e+00  
    ##            incidence_rate  pct_public_coverage_alone  
    ##                 1.903e-01                  6.388e-01  
    ##            pct_other_race                  pct_white  
    ##                -1.038e+00                 -5.818e-02  
    ##               pct_hs18_24            median_age_male  
    ##                 3.450e-01                 -4.905e-01  
    ##                birth_rate     pct_married_households  
    ##                -9.575e-01                 -3.817e-01  
    ##     pct_unemployed16_over                pop_est2015  
    ##                 3.334e-01                 -1.714e-06

``` r
fit_forward = lm(formula = target_death_rate ~ pct_bach_deg25_over + incidence_rate + 
    pct_public_coverage_alone + pct_other_race + pct_white + 
    pct_hs18_24 + median_age_male + birth_rate + pct_married_households + 
    pct_unemployed16_over + pop_est2015, data = cancer_reg_tidy)
##11 predictor model with 2 not significant, R^2(adj) = 0.4988
summary(fit_forward) 
```

    ## 
    ## Call:
    ## lm(formula = target_death_rate ~ pct_bach_deg25_over + incidence_rate + 
    ##     pct_public_coverage_alone + pct_other_race + pct_white + 
    ##     pct_hs18_24 + median_age_male + birth_rate + pct_married_households + 
    ##     pct_unemployed16_over + pop_est2015, data = cancer_reg_tidy)
    ## 
    ## Residuals:
    ##      Min       1Q   Median       3Q      Max 
    ## -104.490  -11.255   -0.372   11.029  137.939 
    ## 
    ## Coefficients:
    ##                             Estimate Std. Error t value Pr(>|t|)    
    ## (Intercept)                1.398e+02  6.989e+00  20.004  < 2e-16 ***
    ## pct_bach_deg25_over       -1.653e+00  9.506e-02 -17.387  < 2e-16 ***
    ## incidence_rate             1.903e-01  6.850e-03  27.778  < 2e-16 ***
    ## pct_public_coverage_alone  6.388e-01  9.827e-02   6.500 9.34e-11 ***
    ## pct_other_race            -1.038e+00  1.134e-01  -9.147  < 2e-16 ***
    ## pct_white                 -5.818e-02  3.145e-02  -1.850   0.0644 .  
    ## pct_hs18_24                3.450e-01  4.475e-02   7.709 1.70e-14 ***
    ## median_age_male           -4.905e-01  7.957e-02  -6.165 8.00e-10 ***
    ## birth_rate                -9.575e-01  1.854e-01  -5.166 2.55e-07 ***
    ## pct_married_households    -3.817e-01  7.697e-02  -4.958 7.50e-07 ***
    ## pct_unemployed16_over      3.334e-01  1.505e-01   2.215   0.0268 *  
    ## pop_est2015               -1.714e-06  1.198e-06  -1.431   0.1525    
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## 
    ## Residual standard error: 19.65 on 3035 degrees of freedom
    ## Multiple R-squared:  0.5006, Adjusted R-squared:  0.4988 
    ## F-statistic: 276.6 on 11 and 3035 DF,  p-value: < 2.2e-16

``` r
# backward
step(full, data = cancer_reg_tidy, direction="backward")
```

    ## Start:  AIC=18170.77
    ## target_death_rate ~ incidence_rate + pop_est2015 + study_per_cap + 
    ##     median_age + median_age_male + avg_household_size + pct_no_hs18_24 + 
    ##     pct_hs18_24 + pct_bach_deg18_24 + pct_bach_deg25_over + pct_unemployed16_over + 
    ##     pct_public_coverage_alone + pct_white + pct_black + pct_asian + 
    ##     pct_other_race + pct_married_households + birth_rate + pct_nonwhite
    ## 
    ## 
    ## Step:  AIC=18170.77
    ## target_death_rate ~ incidence_rate + pop_est2015 + study_per_cap + 
    ##     median_age + median_age_male + avg_household_size + pct_no_hs18_24 + 
    ##     pct_hs18_24 + pct_bach_deg18_24 + pct_bach_deg25_over + pct_unemployed16_over + 
    ##     pct_public_coverage_alone + pct_white + pct_black + pct_asian + 
    ##     pct_other_race + pct_married_households + birth_rate
    ## 
    ##                             Df Sum of Sq     RSS   AIC
    ## - pct_bach_deg18_24          1        11 1170505 18169
    ## - avg_household_size         1        13 1170506 18169
    ## - pct_asian                  1        80 1170574 18169
    ## - median_age                 1        85 1170579 18169
    ## - study_per_cap              1       173 1170667 18169
    ## - pct_black                  1       272 1170766 18170
    ## - pct_no_hs18_24             1       499 1170992 18170
    ## - pop_est2015                1       599 1171093 18170
    ## <none>                                   1170494 18171
    ## - pct_white                  1      1306 1171800 18172
    ## - pct_unemployed16_over      1      1812 1172306 18174
    ## - pct_married_households     1      8350 1178844 18190
    ## - birth_rate                 1     10040 1180534 18195
    ## - median_age_male            1     11096 1181590 18198
    ## - pct_public_coverage_alone  1     15453 1185947 18209
    ## - pct_hs18_24                1     19663 1190157 18220
    ## - pct_other_race             1     29854 1200348 18246
    ## - pct_bach_deg25_over        1     95090 1265584 18407
    ## - incidence_rate             1    287152 1457646 18837
    ## 
    ## Step:  AIC=18168.8
    ## target_death_rate ~ incidence_rate + pop_est2015 + study_per_cap + 
    ##     median_age + median_age_male + avg_household_size + pct_no_hs18_24 + 
    ##     pct_hs18_24 + pct_bach_deg25_over + pct_unemployed16_over + 
    ##     pct_public_coverage_alone + pct_white + pct_black + pct_asian + 
    ##     pct_other_race + pct_married_households + birth_rate
    ## 
    ##                             Df Sum of Sq     RSS   AIC
    ## - avg_household_size         1        12 1170517 18167
    ## - median_age                 1        85 1170590 18167
    ## - pct_asian                  1        88 1170593 18167
    ## - study_per_cap              1       170 1170675 18167
    ## - pct_black                  1       277 1170782 18168
    ## - pct_no_hs18_24             1       488 1170993 18168
    ## - pop_est2015                1       612 1171117 18168
    ## <none>                                   1170505 18169
    ## - pct_white                  1      1316 1171821 18170
    ## - pct_unemployed16_over      1      1865 1172370 18172
    ## - pct_married_households     1      8368 1178873 18189
    ## - birth_rate                 1     10030 1180535 18193
    ## - median_age_male            1     11332 1181837 18196
    ## - pct_public_coverage_alone  1     15551 1186055 18207
    ## - pct_hs18_24                1     20846 1191351 18221
    ## - pct_other_race             1     29913 1200418 18244
    ## - pct_bach_deg25_over        1    103856 1274361 18426
    ## - incidence_rate             1    287562 1458067 18836
    ## 
    ## Step:  AIC=18166.83
    ## target_death_rate ~ incidence_rate + pop_est2015 + study_per_cap + 
    ##     median_age + median_age_male + pct_no_hs18_24 + pct_hs18_24 + 
    ##     pct_bach_deg25_over + pct_unemployed16_over + pct_public_coverage_alone + 
    ##     pct_white + pct_black + pct_asian + pct_other_race + pct_married_households + 
    ##     birth_rate
    ## 
    ##                             Df Sum of Sq     RSS   AIC
    ## - median_age                 1        84 1170601 18165
    ## - pct_asian                  1        89 1170606 18165
    ## - study_per_cap              1       169 1170686 18165
    ## - pct_black                  1       291 1170809 18166
    ## - pct_no_hs18_24             1       485 1171002 18166
    ## - pop_est2015                1       606 1171123 18166
    ## <none>                                   1170517 18167
    ## - pct_white                  1      1377 1171894 18168
    ## - pct_unemployed16_over      1      1909 1172427 18170
    ## - pct_married_households     1      8734 1179251 18188
    ## - birth_rate                 1     10037 1180554 18191
    ## - median_age_male            1     12623 1183140 18198
    ## - pct_public_coverage_alone  1     15675 1186193 18205
    ## - pct_hs18_24                1     20994 1191511 18219
    ## - pct_other_race             1     29917 1200434 18242
    ## - pct_bach_deg25_over        1    103913 1274431 18424
    ## - incidence_rate             1    288627 1459144 18836
    ## 
    ## Step:  AIC=18165.05
    ## target_death_rate ~ incidence_rate + pop_est2015 + study_per_cap + 
    ##     median_age_male + pct_no_hs18_24 + pct_hs18_24 + pct_bach_deg25_over + 
    ##     pct_unemployed16_over + pct_public_coverage_alone + pct_white + 
    ##     pct_black + pct_asian + pct_other_race + pct_married_households + 
    ##     birth_rate
    ## 
    ##                             Df Sum of Sq     RSS   AIC
    ## - pct_asian                  1        86 1170687 18163
    ## - study_per_cap              1       163 1170765 18164
    ## - pct_black                  1       289 1170890 18164
    ## - pct_no_hs18_24             1       483 1171084 18164
    ## - pop_est2015                1       605 1171206 18165
    ## <none>                                   1170601 18165
    ## - pct_white                  1      1372 1171974 18167
    ## - pct_unemployed16_over      1      1875 1172476 18168
    ## - pct_married_households     1      8712 1179313 18186
    ## - birth_rate                 1     10059 1180660 18189
    ## - median_age_male            1     13056 1183658 18197
    ## - pct_public_coverage_alone  1     15792 1186393 18204
    ## - pct_hs18_24                1     20951 1191552 18217
    ## - pct_other_race             1     29966 1200567 18240
    ## - pct_bach_deg25_over        1    103925 1274526 18422
    ## - incidence_rate             1    288544 1459145 18834
    ## 
    ## Step:  AIC=18163.27
    ## target_death_rate ~ incidence_rate + pop_est2015 + study_per_cap + 
    ##     median_age_male + pct_no_hs18_24 + pct_hs18_24 + pct_bach_deg25_over + 
    ##     pct_unemployed16_over + pct_public_coverage_alone + pct_white + 
    ##     pct_black + pct_other_race + pct_married_households + birth_rate
    ## 
    ##                             Df Sum of Sq     RSS   AIC
    ## - study_per_cap              1       169 1170856 18162
    ## - pct_black                  1       218 1170905 18162
    ## - pct_no_hs18_24             1       439 1171127 18162
    ## <none>                                   1170687 18163
    ## - pop_est2015                1       861 1171548 18164
    ## - pct_white                  1      1319 1172006 18165
    ## - pct_unemployed16_over      1      1867 1172555 18166
    ## - pct_married_households     1      8803 1179491 18184
    ## - birth_rate                 1      9978 1180665 18187
    ## - median_age_male            1     13055 1183743 18195
    ## - pct_public_coverage_alone  1     15983 1186670 18203
    ## - pct_hs18_24                1     21083 1191770 18216
    ## - pct_other_race             1     29886 1200573 18238
    ## - pct_bach_deg25_over        1    108230 1278917 18431
    ## - incidence_rate             1    288462 1459149 18832
    ## 
    ## Step:  AIC=18161.71
    ## target_death_rate ~ incidence_rate + pop_est2015 + median_age_male + 
    ##     pct_no_hs18_24 + pct_hs18_24 + pct_bach_deg25_over + pct_unemployed16_over + 
    ##     pct_public_coverage_alone + pct_white + pct_black + pct_other_race + 
    ##     pct_married_households + birth_rate
    ## 
    ##                             Df Sum of Sq     RSS   AIC
    ## - pct_black                  1       220 1171076 18160
    ## - pct_no_hs18_24             1       429 1171285 18161
    ## <none>                                   1170856 18162
    ## - pop_est2015                1       877 1171734 18162
    ## - pct_white                  1      1362 1172218 18163
    ## - pct_unemployed16_over      1      1866 1172722 18165
    ## - pct_married_households     1      8674 1179530 18182
    ## - birth_rate                 1     10096 1180952 18186
    ## - median_age_male            1     12998 1183854 18193
    ## - pct_public_coverage_alone  1     15999 1186856 18201
    ## - pct_hs18_24                1     21082 1191938 18214
    ## - pct_other_race             1     29902 1200759 18237
    ## - pct_bach_deg25_over        1    109240 1280096 18432
    ## - incidence_rate             1    288738 1459594 18831
    ## 
    ## Step:  AIC=18160.28
    ## target_death_rate ~ incidence_rate + pop_est2015 + median_age_male + 
    ##     pct_no_hs18_24 + pct_hs18_24 + pct_bach_deg25_over + pct_unemployed16_over + 
    ##     pct_public_coverage_alone + pct_white + pct_other_race + 
    ##     pct_married_households + birth_rate
    ## 
    ##                             Df Sum of Sq     RSS   AIC
    ## - pct_no_hs18_24             1       407 1171483 18159
    ## <none>                                   1171076 18160
    ## - pop_est2015                1       847 1171923 18161
    ## - pct_white                  1      1592 1172668 18162
    ## - pct_unemployed16_over      1      1836 1172911 18163
    ## - pct_married_households     1      8471 1179547 18180
    ## - birth_rate                 1      9893 1180969 18184
    ## - median_age_male            1     13483 1184559 18193
    ## - pct_public_coverage_alone  1     16707 1187782 18201
    ## - pct_hs18_24                1     21531 1192607 18214
    ## - pct_other_race             1     31435 1202511 18239
    ## - pct_bach_deg25_over        1    112288 1283363 18437
    ## - incidence_rate             1    289168 1460244 18831
    ## 
    ## Step:  AIC=18159.34
    ## target_death_rate ~ incidence_rate + pop_est2015 + median_age_male + 
    ##     pct_hs18_24 + pct_bach_deg25_over + pct_unemployed16_over + 
    ##     pct_public_coverage_alone + pct_white + pct_other_race + 
    ##     pct_married_households + birth_rate
    ## 
    ##                             Df Sum of Sq     RSS   AIC
    ## <none>                                   1171483 18159
    ## - pop_est2015                1       790 1172273 18159
    ## - pct_white                  1      1321 1172804 18161
    ## - pct_unemployed16_over      1      1894 1173376 18162
    ## - pct_married_households     1      9489 1180972 18182
    ## - birth_rate                 1     10300 1181783 18184
    ## - median_age_male            1     14669 1186151 18195
    ## - pct_public_coverage_alone  1     16309 1187792 18200
    ## - pct_hs18_24                1     22942 1194425 18216
    ## - pct_other_race             1     32296 1203779 18240
    ## - pct_bach_deg25_over        1    116690 1288173 18447
    ## - incidence_rate             1    297844 1469327 18848

    ## 
    ## Call:
    ## lm(formula = target_death_rate ~ incidence_rate + pop_est2015 + 
    ##     median_age_male + pct_hs18_24 + pct_bach_deg25_over + pct_unemployed16_over + 
    ##     pct_public_coverage_alone + pct_white + pct_other_race + 
    ##     pct_married_households + birth_rate, data = cancer_reg_tidy)
    ## 
    ## Coefficients:
    ##               (Intercept)             incidence_rate  
    ##                 1.398e+02                  1.903e-01  
    ##               pop_est2015            median_age_male  
    ##                -1.714e-06                 -4.905e-01  
    ##               pct_hs18_24        pct_bach_deg25_over  
    ##                 3.450e-01                 -1.653e+00  
    ##     pct_unemployed16_over  pct_public_coverage_alone  
    ##                 3.334e-01                  6.388e-01  
    ##                 pct_white             pct_other_race  
    ##                -5.818e-02                 -1.038e+00  
    ##    pct_married_households                 birth_rate  
    ##                -3.817e-01                 -9.575e-01

``` r
fit_backward = lm(formula = target_death_rate ~ incidence_rate + pop_est2015 + 
    median_age_male + pct_hs18_24 + pct_bach_deg25_over + pct_unemployed16_over + 
    pct_public_coverage_alone + pct_white + pct_other_race + 
    pct_married_households + birth_rate, data = cancer_reg_tidy)
##same model as forward

#both directions
step(null, scope = list(upper=full), data = cancer_reg_tidy, direction = "both")
```

    ## Start:  AIC=20253.13
    ## target_death_rate ~ 1
    ## 
    ##                             Df Sum of Sq     RSS   AIC
    ## + pct_bach_deg25_over        1    552893 1792973 19436
    ## + incidence_rate             1    473839 1872027 19568
    ## + pct_public_coverage_alone  1    473682 1872183 19568
    ## + pct_unemployed16_over      1    335919 2009947 19784
    ## + pct_married_households     1    201838 2144028 19981
    ## + pct_bach_deg18_24          1    194329 2151537 19992
    ## + pct_hs18_24                1    161000 2184866 20039
    ## + pct_black                  1    154971 2190895 20047
    ## + pct_other_race             1     84591 2261275 20143
    ## + pct_asian                  1     81447 2264419 20148
    ## + pct_white                  1     73826 2272040 20158
    ## + pct_nonwhite               1     73826 2272040 20158
    ## + pop_est2015                1     33822 2312044 20211
    ## + pct_no_hs18_24             1     18358 2327508 20231
    ## + birth_rate                 1     17922 2327944 20232
    ## + avg_household_size         1      3195 2342671 20251
    ## <none>                                   2345866 20253
    ## + study_per_cap              1      1165 2344701 20254
    ## + median_age_male            1      1128 2344738 20254
    ## + median_age                 1        45 2345821 20255
    ## 
    ## Step:  AIC=19436.16
    ## target_death_rate ~ pct_bach_deg25_over
    ## 
    ##                             Df Sum of Sq     RSS   AIC
    ## + incidence_rate             1    436199 1356774 18589
    ## + pct_married_households     1    142974 1649999 19185
    ## + pct_unemployed16_over      1    106117 1686856 19252
    ## + pct_public_coverage_alone  1     89344 1703629 19282
    ## + pct_black                  1     82887 1710086 19294
    ## + pct_other_race             1     68639 1724334 19319
    ## + pct_white                  1     55608 1737365 19342
    ## + pct_nonwhite               1     55608 1737365 19342
    ## + birth_rate                 1     40016 1752957 19369
    ## + pct_no_hs18_24             1     30147 1762826 19387
    ## + median_age_male            1     17581 1775392 19408
    ## + pct_hs18_24                1     12028 1780945 19418
    ## + study_per_cap              1      2199 1790774 19434
    ## + avg_household_size         1      2133 1790840 19435
    ## + pct_asian                  1      2006 1790967 19435
    ## + pop_est2015                1      1525 1791448 19436
    ## <none>                                   1792973 19436
    ## + median_age                 1        71 1792902 19438
    ## + pct_bach_deg18_24          1        42 1792931 19438
    ## - pct_bach_deg25_over        1    552893 2345866 20253
    ## 
    ## Step:  AIC=18588.76
    ## target_death_rate ~ pct_bach_deg25_over + incidence_rate
    ## 
    ##                             Df Sum of Sq     RSS   AIC
    ## + pct_public_coverage_alone  1     80817 1275957 18404
    ## + pct_married_households     1     79924 1276850 18406
    ## + pct_unemployed16_over      1     70660 1286114 18428
    ## + pct_white                  1     51737 1305036 18472
    ## + pct_nonwhite               1     51737 1305036 18472
    ## + pct_black                  1     47135 1309639 18483
    ## + pct_other_race             1     16303 1340471 18554
    ## + birth_rate                 1     14471 1342302 18558
    ## + median_age_male            1     14267 1342507 18559
    ## + pct_hs18_24                1     10915 1345859 18566
    ## + pct_bach_deg18_24          1      2635 1354139 18585
    ## + pct_no_hs18_24             1      1651 1355123 18587
    ## + pct_asian                  1      1480 1355294 18587
    ## + avg_household_size         1      1021 1355753 18589
    ## <none>                                   1356774 18589
    ## + median_age                 1       395 1356379 18590
    ## + pop_est2015                1       158 1356616 18590
    ## + study_per_cap              1        53 1356721 18591
    ## - incidence_rate             1    436199 1792973 19436
    ## - pct_bach_deg25_over        1    515253 1872027 19568
    ## 
    ## Step:  AIC=18403.64
    ## target_death_rate ~ pct_bach_deg25_over + incidence_rate + pct_public_coverage_alone
    ## 
    ##                             Df Sum of Sq     RSS   AIC
    ## + pct_other_race             1     28916 1247041 18336
    ## + pct_married_households     1     24502 1251455 18347
    ## + pct_black                  1     18665 1257292 18361
    ## + pct_unemployed16_over      1     15217 1260741 18369
    ## + pct_white                  1     14355 1261602 18371
    ## + pct_nonwhite               1     14355 1261602 18371
    ## + pct_hs18_24                1     11851 1264106 18377
    ## + birth_rate                 1     10071 1265886 18382
    ## + median_age_male            1      8493 1267464 18385
    ## + pct_no_hs18_24             1      5953 1270004 18391
    ## + pop_est2015                1      1585 1274372 18402
    ## <none>                                   1275957 18404
    ## + pct_bach_deg18_24          1       609 1275348 18404
    ## + median_age                 1       201 1275756 18405
    ## + study_per_cap              1       109 1275848 18405
    ## + avg_household_size         1        38 1275919 18406
    ## + pct_asian                  1        27 1275930 18406
    ## - pct_public_coverage_alone  1     80817 1356774 18589
    ## - pct_bach_deg25_over        1    159542 1435499 18761
    ## - incidence_rate             1    427672 1703629 19282
    ## 
    ## Step:  AIC=18335.79
    ## target_death_rate ~ pct_bach_deg25_over + incidence_rate + pct_public_coverage_alone + 
    ##     pct_other_race
    ## 
    ##                             Df Sum of Sq     RSS   AIC
    ## + pct_white                  1     24975 1222067 18276
    ## + pct_nonwhite               1     24975 1222067 18276
    ## + pct_married_households     1     23832 1223210 18279
    ## + median_age_male            1     20202 1226839 18288
    ## + pct_black                  1     16846 1230195 18296
    ## + pct_unemployed16_over      1     14408 1232633 18302
    ## + pct_hs18_24                1     10213 1236828 18313
    ## + birth_rate                 1      8453 1238588 18317
    ## + pct_no_hs18_24             1      3631 1243410 18329
    ## + avg_household_size         1      1692 1245349 18334
    ## + pct_asian                  1      1568 1245473 18334
    ## <none>                                   1247041 18336
    ## + pct_bach_deg18_24          1       524 1246517 18337
    ## + median_age                 1       333 1246708 18337
    ## + study_per_cap              1       125 1246916 18338
    ## + pop_est2015                1         0 1247041 18338
    ## - pct_other_race             1     28916 1275957 18404
    ## - pct_public_coverage_alone  1     93430 1340471 18554
    ## - pct_bach_deg25_over        1    142742 1389783 18664
    ## - incidence_rate             1    363455 1610496 19113
    ## 
    ## Step:  AIC=18276.15
    ## target_death_rate ~ pct_bach_deg25_over + incidence_rate + pct_public_coverage_alone + 
    ##     pct_other_race + pct_white
    ## 
    ##                             Df Sum of Sq     RSS   AIC
    ## + pct_hs18_24                1     12383 1209683 18247
    ## + birth_rate                 1      9357 1212710 18255
    ## + median_age_male            1      8034 1214033 18258
    ## + pct_married_households     1      7434 1214632 18260
    ## + pct_no_hs18_24             1      5761 1216305 18264
    ## + pct_unemployed16_over      1      3995 1218071 18268
    ## <none>                                   1222067 18276
    ## + pct_bach_deg18_24          1       416 1221650 18277
    ## + avg_household_size         1       399 1221667 18277
    ## + pop_est2015                1       310 1221757 18277
    ## + median_age                 1       198 1221868 18278
    ## + study_per_cap              1        50 1222016 18278
    ## + pct_black                  1        46 1222020 18278
    ## + pct_asian                  1        10 1222056 18278
    ## - pct_white                  1     24975 1247041 18336
    ## - pct_other_race             1     39535 1261602 18371
    ## - pct_public_coverage_alone  1     47288 1269354 18390
    ## - pct_bach_deg25_over        1    162109 1384176 18654
    ## - incidence_rate             1    353494 1575561 19048
    ## 
    ## Step:  AIC=18247.12
    ## target_death_rate ~ pct_bach_deg25_over + incidence_rate + pct_public_coverage_alone + 
    ##     pct_other_race + pct_white + pct_hs18_24
    ## 
    ##                             Df Sum of Sq     RSS   AIC
    ## + median_age_male            1     12822 1196862 18217
    ## + pct_married_households     1     12167 1197517 18218
    ## + birth_rate                 1     10008 1199676 18224
    ## + pct_no_hs18_24             1      4522 1205162 18238
    ## + pct_unemployed16_over      1      3928 1205756 18239
    ## <none>                                   1209683 18247
    ## + median_age                 1       358 1209326 18248
    ## + pop_est2015                1       247 1209436 18249
    ## + avg_household_size         1       183 1209501 18249
    ## + study_per_cap              1        27 1209656 18249
    ## + pct_asian                  1        11 1209673 18249
    ## + pct_bach_deg18_24          1         6 1209677 18249
    ## + pct_black                  1         5 1209679 18249
    ## - pct_hs18_24                1     12383 1222067 18276
    ## - pct_white                  1     27144 1236828 18313
    ## - pct_other_race             1     38062 1247746 18340
    ## - pct_public_coverage_alone  1     46438 1256122 18360
    ## - pct_bach_deg25_over        1    120227 1329911 18534
    ## - incidence_rate             1    353337 1563020 19026
    ## 
    ## Step:  AIC=18216.65
    ## target_death_rate ~ pct_bach_deg25_over + incidence_rate + pct_public_coverage_alone + 
    ##     pct_other_race + pct_white + pct_hs18_24 + median_age_male
    ## 
    ##                             Df Sum of Sq     RSS   AIC
    ## + birth_rate                 1     13243 1183619 18185
    ## + pct_married_households     1     11751 1185110 18189
    ## + pct_unemployed16_over      1      3087 1193774 18211
    ## + pct_no_hs18_24             1      2482 1194379 18212
    ## <none>                                   1196862 18217
    ## + avg_household_size         1       443 1196419 18218
    ## + pop_est2015                1       366 1196496 18218
    ## + pct_black                  1       207 1196655 18218
    ## + pct_bach_deg18_24          1       180 1196682 18218
    ## + pct_asian                  1        91 1196771 18218
    ## + study_per_cap              1        77 1196784 18219
    ## + median_age                 1        31 1196830 18219
    ## - pct_white                  1     12407 1209269 18246
    ## - median_age_male            1     12822 1209683 18247
    ## - pct_hs18_24                1     17171 1214033 18258
    ## - pct_other_race             1     45705 1242567 18329
    ## - pct_public_coverage_alone  1     50853 1247714 18341
    ## - pct_bach_deg25_over        1    120131 1316993 18506
    ## - incidence_rate             1    343329 1540191 18983
    ## 
    ## Step:  AIC=18184.75
    ## target_death_rate ~ pct_bach_deg25_over + incidence_rate + pct_public_coverage_alone + 
    ##     pct_other_race + pct_white + pct_hs18_24 + median_age_male + 
    ##     birth_rate
    ## 
    ##                             Df Sum of Sq     RSS   AIC
    ## + pct_married_households     1      9581 1174038 18162
    ## + pct_unemployed16_over      1      1981 1181638 18182
    ## + pct_no_hs18_24             1      1445 1182174 18183
    ## <none>                                   1183619 18185
    ## + pop_est2015                1       541 1183078 18185
    ## + avg_household_size         1       347 1183272 18186
    ## + pct_asian                  1       215 1183404 18186
    ## + study_per_cap              1        29 1183590 18187
    ## + pct_bach_deg18_24          1        25 1183594 18187
    ## + median_age                 1        24 1183595 18187
    ## + pct_black                  1         0 1183619 18187
    ## - pct_white                  1     11983 1195602 18213
    ## - birth_rate                 1     13243 1196862 18217
    ## - median_age_male            1     16057 1199676 18224
    ## - pct_hs18_24                1     18763 1202382 18231
    ## - pct_other_race             1     44795 1228414 18296
    ## - pct_public_coverage_alone  1     46950 1230569 18301
    ## - pct_bach_deg25_over        1    127601 1311220 18495
    ## - incidence_rate             1    322985 1506604 18918
    ## 
    ## Step:  AIC=18161.98
    ## target_death_rate ~ pct_bach_deg25_over + incidence_rate + pct_public_coverage_alone + 
    ##     pct_other_race + pct_white + pct_hs18_24 + median_age_male + 
    ##     birth_rate + pct_married_households
    ## 
    ##                             Df Sum of Sq     RSS   AIC
    ## + pct_unemployed16_over      1      1765 1172273 18159
    ## <none>                                   1174038 18162
    ## + pop_est2015                1       662 1173376 18162
    ## + pct_no_hs18_24             1       407 1173631 18163
    ## + study_per_cap              1       172 1173866 18164
    ## + pct_black                  1       147 1173892 18164
    ## + pct_asian                  1       102 1173937 18164
    ## + pct_bach_deg18_24          1        51 1173988 18164
    ## + avg_household_size         1        48 1173990 18164
    ## + median_age                 1        40 1173998 18164
    ## - pct_white                  1      2498 1176536 18167
    ## - pct_married_households     1      9581 1183619 18185
    ## - birth_rate                 1     11072 1185110 18189
    ## - median_age_male            1     15337 1189376 18200
    ## - pct_hs18_24                1     23348 1197387 18220
    ## - pct_public_coverage_alone  1     25953 1199992 18227
    ## - pct_other_race             1     38262 1212300 18258
    ## - pct_bach_deg25_over        1    134195 1308233 18490
    ## - incidence_rate             1    300897 1474935 18855
    ## 
    ## Step:  AIC=18159.4
    ## target_death_rate ~ pct_bach_deg25_over + incidence_rate + pct_public_coverage_alone + 
    ##     pct_other_race + pct_white + pct_hs18_24 + median_age_male + 
    ##     birth_rate + pct_married_households + pct_unemployed16_over
    ## 
    ##                             Df Sum of Sq     RSS   AIC
    ## + pop_est2015                1       790 1171483 18159
    ## <none>                                   1172273 18159
    ## + pct_no_hs18_24             1       350 1171923 18161
    ## - pct_white                  1      1225 1173499 18161
    ## + study_per_cap              1       176 1172097 18161
    ## + pct_black                  1       172 1172101 18161
    ## + pct_asian                  1       122 1172151 18161
    ## + median_age                 1        70 1172203 18161
    ## + pct_bach_deg18_24          1        10 1172263 18161
    ## + avg_household_size         1        10 1172264 18161
    ## - pct_unemployed16_over      1      1765 1174038 18162
    ## - pct_married_households     1      9365 1181638 18182
    ## - birth_rate                 1     10150 1182424 18184
    ## - median_age_male            1     14482 1186755 18195
    ## - pct_public_coverage_alone  1     16007 1188281 18199
    ## - pct_hs18_24                1     22990 1195263 18217
    ## - pct_other_race             1     35974 1208248 18250
    ## - pct_bach_deg25_over        1    132199 1304473 18483
    ## - incidence_rate             1    297143 1469416 18846
    ## 
    ## Step:  AIC=18159.34
    ## target_death_rate ~ pct_bach_deg25_over + incidence_rate + pct_public_coverage_alone + 
    ##     pct_other_race + pct_white + pct_hs18_24 + median_age_male + 
    ##     birth_rate + pct_married_households + pct_unemployed16_over + 
    ##     pop_est2015
    ## 
    ##                             Df Sum of Sq     RSS   AIC
    ## <none>                                   1171483 18159
    ## - pop_est2015                1       790 1172273 18159
    ## + pct_no_hs18_24             1       407 1171076 18160
    ## - pct_white                  1      1321 1172804 18161
    ## + pct_black                  1       198 1171285 18161
    ## + study_per_cap              1       160 1171323 18161
    ## + median_age                 1        74 1171409 18161
    ## + avg_household_size         1        18 1171465 18161
    ## + pct_asian                  1         4 1171479 18161
    ## + pct_bach_deg18_24          1         0 1171483 18161
    ## - pct_unemployed16_over      1      1894 1173376 18162
    ## - pct_married_households     1      9489 1180972 18182
    ## - birth_rate                 1     10300 1181783 18184
    ## - median_age_male            1     14669 1186151 18195
    ## - pct_public_coverage_alone  1     16309 1187792 18200
    ## - pct_hs18_24                1     22942 1194425 18216
    ## - pct_other_race             1     32296 1203779 18240
    ## - pct_bach_deg25_over        1    116690 1288173 18447
    ## - incidence_rate             1    297844 1469327 18848

    ## 
    ## Call:
    ## lm(formula = target_death_rate ~ pct_bach_deg25_over + incidence_rate + 
    ##     pct_public_coverage_alone + pct_other_race + pct_white + 
    ##     pct_hs18_24 + median_age_male + birth_rate + pct_married_households + 
    ##     pct_unemployed16_over + pop_est2015, data = cancer_reg_tidy)
    ## 
    ## Coefficients:
    ##               (Intercept)        pct_bach_deg25_over  
    ##                 1.398e+02                 -1.653e+00  
    ##            incidence_rate  pct_public_coverage_alone  
    ##                 1.903e-01                  6.388e-01  
    ##            pct_other_race                  pct_white  
    ##                -1.038e+00                 -5.818e-02  
    ##               pct_hs18_24            median_age_male  
    ##                 3.450e-01                 -4.905e-01  
    ##                birth_rate     pct_married_households  
    ##                -9.575e-01                 -3.817e-01  
    ##     pct_unemployed16_over                pop_est2015  
    ##                 3.334e-01                 -1.714e-06

``` r
fit_both_dir = lm(formula = target_death_rate ~ pct_bach_deg25_over + incidence_rate + 
    pct_public_coverage_alone + pct_other_race + pct_white + 
    pct_hs18_24 + median_age_male + birth_rate + pct_married_households + 
    pct_unemployed16_over + pop_est2015, data = cancer_reg_tidy)
##same model as forward, backward

#criterion based
best = function(model, ...) {

  subsets <- regsubsets(formula(model), nvmax = 19, model.frame(model), ...)
  subsets <- with(summary(subsets), cbind(p = as.numeric(rownames(which)), which, rss, rsq, adjr2, cp, bic))
  
  return(subsets)
} 
cp_r2_df = best(full, nbest = 1)
```

    ## Warning in leaps.setup(x, y, wt = wt, nbest = nbest, nvmax = nvmax,
    ## force.in = force.in, : 1 linear dependencies found

    ## Warning in leaps.setup(x, y, wt = wt, nbest = nbest, nvmax = nvmax,
    ## force.in = force.in, : nvmax reduced to 18

``` r
#cp_r2_df %>% as.data.frame() %>% filter(p == 11|p ==12) %>% View()
cp_r2_df %>% knitr::kable()
```

|    p|  (Intercept)|  incidence\_rate|  pop\_est2015|  study\_per\_cap|  median\_age|  median\_age\_male|  avg\_household\_size|  pct\_no\_hs18\_24|  pct\_hs18\_24|  pct\_bach\_deg18\_24|  pct\_bach\_deg25\_over|  pct\_unemployed16\_over|  pct\_public\_coverage\_alone|  pct\_white|  pct\_black|  pct\_asian|  pct\_other\_race|  pct\_married\_households|  birth\_rate|  pct\_nonwhite|      rss|        rsq|      adjr2|           cp|         bic|
|----:|------------:|----------------:|-------------:|----------------:|------------:|------------------:|---------------------:|------------------:|--------------:|---------------------:|-----------------------:|------------------------:|-----------------------------:|-----------:|-----------:|-----------:|-----------------:|-------------------------:|------------:|--------------:|--------:|----------:|----------:|------------:|-----------:|
|    1|            1|                0|             0|                0|            0|                  0|                     0|                  0|              0|                     0|                       1|                        0|                             0|           0|           0|           0|                 0|                         0|            0|              0|  1792973|  0.2356882|  0.2354372|  1593.785254|   -802.9273|
|    2|            1|                1|             0|                0|            0|                  0|                     0|                  0|              0|                     0|                       1|                        0|                             0|           0|           0|           0|                 0|                         0|            0|              0|  1356774|  0.4216319|  0.4212519|   467.736355|  -1644.3033|
|    3|            1|                1|             0|                0|            0|                  0|                     0|                  0|              0|                     0|                       1|                        0|                             1|           0|           0|           0|                 0|                         0|            0|              0|  1275957|  0.4560827|  0.4555464|   260.737013|  -1823.4074|
|    4|            1|                1|             0|                0|            0|                  0|                     0|                  0|              0|                     0|                       1|                        0|                             1|           0|           0|           0|                 1|                         0|            0|              0|  1247041|  0.4684090|  0.4677100|   187.957676|  -1885.2317|
|    5|            1|                1|             0|                0|            0|                  0|                     0|                  0|              0|                     0|                       1|                        0|                             1|           0|           0|           0|                 1|                         0|            0|              1|  1222067|  0.4790552|  0.4781987|   125.371305|  -1938.8515|
|    6|            1|                1|             0|                0|            0|                  0|                     0|                  0|              1|                     0|                       1|                        0|                             1|           0|           0|           0|                 1|                         1|            0|              0|  1205000|  0.4863304|  0.4853166|    83.235855|  -1973.6817|
|    7|            1|                1|             0|                0|            0|                  1|                     0|                  0|              1|                     0|                       1|                        0|                             1|           0|           0|           0|                 1|                         1|            0|              0|  1187298|  0.4938764|  0.4927106|    39.457176|  -2010.7534|
|    8|            1|                1|             0|                0|            0|                  1|                     0|                  0|              1|                     0|                       1|                        0|                             1|           0|           0|           0|                 1|                         1|            1|              0|  1176536|  0.4984640|  0.4971433|    13.625734|  -2030.4763|
|    9|            1|                1|             0|                0|            0|                  1|                     0|                  0|              1|                     0|                       1|                        1|                             1|           0|           0|           0|                 1|                         1|            1|              0|  1173499|  0.4997588|  0.4982764|     7.770534|  -2030.3310|
|   10|            1|                1|             0|                0|            0|                  1|                     0|                  0|              1|                     0|                       1|                        1|                             1|           1|           0|           0|                 1|                         1|            1|              0|  1172273|  0.5002812|  0.4986352|     6.601474|  -2025.4926|
|   11|            1|                1|             1|                0|            0|                  1|                     0|                  0|              1|                     0|                       1|                        1|                             1|           1|           0|           0|                 1|                         1|            1|              0|  1171483|  0.5006181|  0.4988082|     6.557461|  -2019.5258|
|   12|            1|                1|             1|                0|            0|                  1|                     0|                  1|              1|                     0|                       1|                        1|                             1|           1|           0|           0|                 1|                         1|            1|              0|  1171076|  0.5007917|  0.4988172|     7.504770|  -2012.5628|
|   13|            1|                1|             1|                0|            0|                  1|                     0|                  1|              1|                     0|                       1|                        1|                             1|           0|           1|           0|                 1|                         1|            1|              1|  1170856|  0.5008853|  0.4987460|     8.936550|  -2005.1126|
|   14|            1|                1|             1|                1|            0|                  1|                     0|                  1|              1|                     0|                       1|                        1|                             1|           1|           1|           0|                 1|                         1|            1|              0|  1170687|  0.5009572|  0.4986529|    10.500488|  -1997.5296|
|   15|            1|                1|             1|                1|            0|                  1|                     0|                  1|              1|                     0|                       1|                        1|                             1|           0|           1|           1|                 1|                         1|            1|              1|  1170601|  0.5009939|  0.4985244|    12.277633|  -1989.7320|
|   16|            1|                1|             1|                1|            1|                  1|                     0|                  1|              1|                     0|                       1|                        1|                             1|           1|           1|           1|                 1|                         1|            1|              0|  1170517|  0.5010298|  0.4983949|    14.060262|  -1981.9288|
|   17|            1|                1|             1|                1|            1|                  1|                     1|                  1|              1|                     0|                       1|                        1|                             1|           1|           1|           1|                 1|                         1|            1|              0|  1170505|  0.5010350|  0.4982346|    16.028455|  -1973.9389|
|   18|            1|                1|             1|                1|            1|                  1|                     1|                  1|              1|                     1|                       1|                        1|                             1|           1|           1|           1|                 1|                         1|            1|              0|  1170494|  0.5010397|  0.4980736|    18.000000|  -1965.9457|

``` r
fit_cp = lm(target_death_rate ~ incidence_rate + pop_est2015 + median_age_male + pct_hs18_24 + 
              pct_bach_deg25_over +  pct_unemployed16_over + pct_public_coverage_alone + pct_white + pct_other_race +
              pct_married_households + birth_rate , data = cancer_reg_tidy)
##minimum cp model is a 11 predictor model with cp = 6.55, adj R2=0.498808

fit_r2 = lm(target_death_rate ~ incidence_rate + pop_est2015 + median_age_male + pct_hs18_24 + pct_no_hs18_24 +
              pct_bach_deg25_over +  pct_unemployed16_over + pct_public_coverage_alone + pct_white + pct_other_race +
              pct_married_households + birth_rate , data = cancer_reg_tidy)
##maximum adjusted R2 model is a 12 predictor model with cp = 7.5, adj R2 = 0.498817

##The final model based on small increase of adjusted R2 and not too large cp
#cp_r2_df %>% as.data.frame() %>%  filter(p == 7)

model_7 = lm(target_death_rate ~ incidence_rate + median_age_male + pct_hs18_24 + pct_bach_deg25_over +
               pct_public_coverage_alone + pct_other_race + pct_married_households, data = cancer_reg_tidy)
#residual covariate plot
plot(cancer_reg_tidy$incidence_rate, model_7$residuals)
abline(h=0, lwd=2, col=2)
```

![](jy2947_Dec15_files/figure-markdown_github/from_load_to_model-1.png)

``` r
plot(cancer_reg_tidy$median_age_male, model_7$residuals)
abline(h=0, lwd=2, col=2)
```

![](jy2947_Dec15_files/figure-markdown_github/from_load_to_model-2.png)

``` r
plot(cancer_reg_tidy$pct_hs18_24, model_7$residuals)
abline(h=0, lwd=2, col=2)
```

![](jy2947_Dec15_files/figure-markdown_github/from_load_to_model-3.png)

``` r
plot(cancer_reg_tidy$pct_bach_deg25_over, model_7$residuals)
abline(h=0, lwd=2, col=2)
```

![](jy2947_Dec15_files/figure-markdown_github/from_load_to_model-4.png)

``` r
plot(cancer_reg_tidy$pct_public_coverage_alone, model_7$residuals)
abline(h=0, lwd=2, col=2)
```

![](jy2947_Dec15_files/figure-markdown_github/from_load_to_model-5.png)

``` r
plot(cancer_reg_tidy$pct_other_race, model_7$residuals)
abline(h=0, lwd=2, col=2)
```

![](jy2947_Dec15_files/figure-markdown_github/from_load_to_model-6.png)

``` r
plot(cancer_reg_tidy$pct_married_households, model_7$residuals)
abline(h=0, lwd=2, col=2)
```

![](jy2947_Dec15_files/figure-markdown_github/from_load_to_model-7.png)
